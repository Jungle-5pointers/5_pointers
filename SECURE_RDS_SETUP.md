# 🔒 안전한 RDS 보안 그룹 설정 가이드

## 현재 상황
- 현재 개발자 IP: 1.238.129.195
- 백엔드 서버 IP: 3.39.235.190
- 프론트엔드 서버 IP: 3.35.227.214
- 서브도메인 서버 IP: 13.125.227.27
- WebSocket 서버 IP: 43.203.138.8

## 🔧 안전한 보안 그룹 설정

### AWS RDS 보안 그룹 인바운드 규칙:

1. **개발자 액세스** (테스트용)
   ```
   유형: MySQL/Aurora
   포트: 3306
   소스: 1.238.129.195/32
   설명: Developer Access
   ```

2. **백엔드 서버 액세스** (필수)
   ```
   유형: MySQL/Aurora
   포트: 3306
   소스: 3.39.235.190/32
   설명: Backend Server Access
   ```

3. **프론트엔드 서버 액세스** (필요시)
   ```
   유형: MySQL/Aurora
   포트: 3306
   소스: 3.35.227.214/32
   설명: Frontend Server Access
   ```

4. **서브도메인 서버 액세스** (필요시)
   ```
   유형: MySQL/Aurora
   포트: 3306
   소스: 13.125.227.27/32
   설명: Subdomain Server Access
   ```

5. **WebSocket 서버 액세스** (필요시)
   ```
   유형: MySQL/Aurora
   포트: 3306
   소스: 43.203.138.8/32
   설명: WebSocket Server Access
   ```

## 📋 설정 단계

### 1단계: AWS 콘솔에서 보안 그룹 설정
1. AWS 콘솔 → RDS → pointers-mysql-db
2. 연결 및 보안 → VPC 보안 그룹 클릭
3. 인바운드 규칙 → 규칙 편집
4. 위의 5개 규칙을 각각 추가
5. 규칙 저장

### 2단계: 연결 테스트
```bash
node test-rds-connection-detailed.js
```

### 3단계: 단계적 테스트
1. 먼저 개발자 IP (1.238.129.195/32)만 추가하여 테스트
2. 연결 성공 시 백엔드 서버 IP (3.39.235.190/32) 추가
3. 필요에 따라 다른 서버 IP들 추가

## 🔍 최소 권한 원칙

### 필수 IP (반드시 필요):
- ✅ 1.238.129.195/32 (개발자 - 테스트용)
- ✅ 3.39.235.190/32 (백엔드 서버 - 필수)

### 선택적 IP (필요시만):
- ⚠️ 3.35.227.214/32 (프론트엔드 - 직접 DB 접근 불필요)
- ⚠️ 13.125.227.27/32 (서브도메인 - 백엔드 API 통해 접근)
- ⚠️ 43.203.138.8/32 (WebSocket - 직접 DB 접근 불필요)

## 🚨 보안 권장사항

1. **최소한의 IP만 허용**: 백엔드 서버 + 개발자 IP
2. **정기적 검토**: 불필요한 IP 규칙 제거
3. **임시 액세스**: 개발 완료 후 개발자 IP 제거 고려
4. **모니터링**: CloudWatch로 RDS 접근 로그 모니터링

## 🔧 단계별 적용 방법

### Phase 1: 최소 설정 (권장)
```
1.238.129.195/32 (개발자)
3.39.235.190/32 (백엔드 서버)
```

### Phase 2: 필요시 확장
다른 서버들이 직접 DB 접근이 필요한 경우에만 추가
